<!DOCTYPE html>
<html>
<head>
    <title>Web App </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='nav.css') }}">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" />
  
  <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
	<style>
		.loader-wrapper {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgb(0 0 0 / 56%);
			display: none;
			align-items: center;
			justify-content: center;
			z-index: 99999;
		}

			.loader {
			border: 5px solid #f3f3f3;
			border-top: 5px solid #3498db;
			border-radius: 50%;
			width: 50px;
			height: 50px;
			animation: spin 1s linear infinite;
			}
	</style>
  

</head>
<body>
	<div class="loader-wrapper">
        <div class="loader"></div>
    </div>
    <section id="our_menu" class="pt-5 pb-5">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="d-flex justify-content-center mb-4 p-0 page_title text-center">
						<img src="https://barbqtonight.com/assets/img/bbqtonight.png" class="img-fluid" style="
    max-width: 190px;
">
						<div class="single_line"></div>
					</div>
				</div>
			</div>
			<div class="row">
				<ul class="nav nav-tabs menu_tab mb-4" id="myTab" role="tablist">
					
				</ul>
        	</div>
			<div class="row ">
				<div class="tab-content col-lg-12" id="myTabContent">
					
				</div>
				<a href="#" class="d-none menu_btn btn btn-danger">view more</a>
			</div>
		</div>
	</section>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>   
	<script>
		$(document).ready(function(){
			let baseUrl = new URL(window.location.href);
			baseUrl = `${baseUrl.protocol}//${baseUrl.hostname}:${baseUrl.port}`;
			document.querySelector('.loader-wrapper').style.display = 'flex';
			axios({
			method: 'POST',
			url: baseUrl + '/menudata',
			
		}).then(res => {
			let data = res.data;
			console.log(data);
			var tabs = {};
            // Group data by category
            data.forEach(function(item){
                var category = item[2];
                if (!tabs[category]) {
                    tabs[category] = [];
                }
                tabs[category].push(item);
            });
			console.log(tabs);
			$.each(tabs, function(category, items){
				console.log("ok")
				var navPill = $('<li class="nav-item"><a class="nav-link" id="' + category + '-tab" data-toggle="pill" href="#' + category + '" role="tab" aria-controls="' + category + '" aria-selected="true">' + category.replace(/_/g, ' ') + '</a></li>');
                $('#myTab').append(navPill);

				// var tabPane = $('<div class="tab-pane fade" id="' + category + '" role="tabpanel" aria-labelledby="' + category + '-tab"></div>');
                // var content = '';
				const tabcontent=`
				<div class="tab-pane fade show " id="${category}" role="tabpanel" aria-labelledby="breakfast-tab">
						<div class="row">
							
								${items.map(data => `
								<div class="col-lg-2 col-md-2 h-100 m-0 p-0 px-1 col-sm-6 pb-2 col-6"><div class="bg-white  h-100 p-2 shadow-lg single_menu">
									<div class="m-0 p-0">
										<div class="border-0"><img src="${data[0]}"></div>
										<div><div class="text-capitalize font-weight-bold h6 my-3 text-center text-dark">${formatName(data[1])}</div></div>
										<div class="border-top font-weight-bold px-0 py-3 text-center">From Rs. ${data[3]}</div>
									</div>
									</div>
								</div>
								`).join('')}
							
						</div>
				</div>			
				`
                
                
                $('#myTabContent').append(tabcontent);
				$('#BBQ_Special').addClass('active');
				
				$('#BBQ_Special-tab').addClass('active');
				document.querySelector('.loader-wrapper').style.display = 'none';
			});

		}).catch(err => {
			console.error(err);
		});
		function formatName(filename) {
			
			let nameWithoutExtension = filename.split('.').slice(0, -1).join('.');		
			let formattedName = nameWithoutExtension.replace(/-/g, ' ');
			formattedName = formattedName.replace(/\b\w/g, function(char) {
				return char.toUpperCase();
			});
			
			return formattedName;
		}

		});
	
	</script>
 

</body>
</html>
